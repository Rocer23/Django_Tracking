{% extends "base.html" %}
{% load static %}

{% block content %}

<h1>Task Details</h1>

<h2>{{ task.title }}</h2>

<hr>
<p>{{ task.description }}</p>

<hr>
<p>{{ task.start }}</p>

<p>Status: {{ task.status }}</p>

<a class="btn btn-primary" href="{% url 'index' %}">–ù–∞–∑–∞–¥</a>

<hr>
<h3>–ö–æ–º–µ–Ω—Ç–∞—Ä—ñ</h3>

{% if  request.user.is_authenticated %}
    <form id="comment-form" method="POST" action="{% url 'task-comment' task.id %}">
        {% csrf_token %}
        <input type="text" id="comment-text" name="text" placeholder="–í–≤–µ–¥—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä–∏–π">
        <button class="btn btn-primary" type="submit">–î–æ–¥–∞—Ç–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä–∏–π</button>
    </form>
{% else %}
    <p>–¢—Ä–µ–±–∞ –∞–≤—Ç–æ—Ä–∏–∑—É–≤–∞—Ç–∏—Å—å, —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ</p>
    <a href="{% url 'login' %}">–ê–≤—Ç–æ—Ä–∏–∑—É–≤–∞—Ç–∏—Å—å</a>

{% endif %}

<ul id="comment-list">
    {% for comment in task.comments.all %}
      <li>
        <strong>{{ comment.user.username }}</strong>: {{comment.text}} ({{ comment.created_at }})

        <br>
        {% if request.user == comment.user %}
        <button class="edit-btn btn btn-primary" data-task-id="{{ task.id }}" data-comment-id="{{ comment.id }}">
            Edit
        </button>
        <button class="delete-btn btn btn-danger" data-task-id="{{ task.id }}" data-comment-id="{{ comment.id }}">
            Delete
        </button>
        {% endif %}


        <button class="like-btn" data-comment-id="{{ comment.id }}" data-task-id="{{ task.id }}">üëç<span id="like-count-{{ comment.id }}">{{ comment.likes }}</span></button>
        <button class="dislike-btn" data-comment-id="{{ comment.id }}" data-task-id="{{ task.id }}">üëé<span id="dislike-count-{{ comment.id }}" >{{ comment.dislikes }}</span></button>
    </li>
    {% endfor %}
</ul>

{% endblock %}